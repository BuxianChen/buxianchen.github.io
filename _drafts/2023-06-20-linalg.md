---
layout: post
title: "(WIP) 线性代数回顾"
date: 2023-06-20 13:50:04 +0800
labels: [math]
---

## 动机、参考资料、涉及内容

动机

- GPTQ 算法中涉及到一些关于矩阵的逆, 矩阵分解的内容

参考资料

待定

涉及内容

- 线性代数定理(重结论, 适当证明)
- numpy/torch 相关函数的使用

不涉及内容

待定

## 正定/半正定矩阵

实正定矩阵对角线元素必为正数?

实半正定矩阵对角线元素非负? 分解后非零元的个数等于秩

实对称矩阵/正交/正定矩阵的分解形式

## Cholesky 矩阵分解

PSD (Positive Semi-Definite matrix) 表示半正定矩阵, PD (Positive Definite matrix) 表示正定矩阵.


```python
import torch
from torch.utils import benchmark

n = 256
k = 100

a = torch.randn((n, n))
M = a @ a.T + torch.eye(n)
y = torch.empty_like(M)
z = torch.empty_like(M)

t = benchmark.Timer(stmt="torch.inverse(M, out=y)", globals={"M": M, "y": y}).blocked_autorange(min_run_time=3).median
print(f"inverse ({n}, {n}) matrix, median time usage: {t*1000}ms")  # 0.71ms

t = benchmark.Timer(stmt="torch.cholesky_inverse(torch.linalg.cholesky(M), out=z)", globals={"M": M, "z": z}).blocked_autorange(min_run_time=3).median
print(f"cholesky_inverse ({n}, {n}) matrix, median time usage: {t*1000}ms")  # 0.60ms
```